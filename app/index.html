<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>WHEEL</title>
  <link
    href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=RocknRoll+One&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="css/style.min.css">
  
</head>


 <!-- start content -->
 <div class="content">
  <div class="wrapper">
    <h1>SPIN THE WHEEL</h1>
    <div class="prize-title" id="prize-title">Prize 5</div>
    <div class="wheel-container">
      <div class="wheel" id="wheel"></div>
    </div>
    <button id="spin" class="button">PRESS HERE</button>
  </div>

  <!-- start winners list -->
  <div class="winners-list-wrapper">
    <div class="winner-list__title">Недавние победители</div>
    <div class="winner-list">


      <div class="winner-item">

        <div class="winner-info">

          <div class="winner-photo">
            <img src="img/photo.png" alt="">
        </div>

        <div class="winner-name">
          Анастасияаошгшщоршгр
        </div>
        </div>

        <div class="date-quantity">
          <div class="quantity">
            <span>5</span>
            Кредитов
          </div>
          <div class="date">17.05.2024</div>
        </div>
        
      </div>

      <div class="winner-item">

        <div class="winner-info">

          <div class="winner-photo">
            <img src="img/p1.png" alt="">
        </div>

        <div class="winner-name">
          Emily
        </div>
        </div>

        <div class="date-quantity">
          <div class="quantity">
            <span>2</span>
            Prize
          </div>
          <div class="date">17.05.2024</div>
        </div>
        
      </div>

      <div class="winner-item">

        <div class="winner-info">

          <div class="winner-photo">
            <img src="img/p2.png" alt="">
        </div>

        <div class="winner-name">
          Olivia
        </div>
        </div>

        <div class="date-quantity">
          <div class="quantity">
            <span>5</span>
            Prize 
          </div>
          <div class="date">17.05.2024</div>
        </div>
        
      </div>

      <div class="winner-item">

        <div class="winner-info">

          <div class="winner-photo">
            <img src="img/p3.png" alt="">
        </div>

        <div class="winner-name">
          Isabella
        </div>
        </div>

        <div class="date-quantity">
          <div class="quantity">
            <span>1</span>
            Prize 
          </div>
          <div class="date">17.05.2024</div>
        </div>
        
      </div>

      <div class="winner-item">

        <div class="winner-info">

          <div class="winner-photo">
            <img src="img/p4.png" alt="">
        </div>

        <div class="winner-name">
          Sophia
        </div>
        </div>

        <div class="date-quantity">
          <div class="quantity">
            <span>4</span>
            Prize 
          </div>
          <div class="date">17.05.2024</div>
        </div>
        
      </div>

      <div class="winner-item">

        <div class="winner-info">

          <div class="winner-photo">
            <img src="img/photo2.jpg" alt="">
        </div>

        <div class="winner-name">
          Ava
        </div>
        </div>

        <div class="date-quantity">
          <div class="quantity">
            <span>3</span>
            Prize 
          </div>
          <div class="date">17.05.2024</div>
        </div>
        
      </div>

      <div class="winner-item">

        <div class="winner-info">

          <div class="winner-photo">
            <img src="img/photo3.jpg" alt="">
        </div>

        <div class="winner-name">
          Jack
        </div>
        </div>

        <div class="date-quantity">
          <div class="quantity">
            <span>4</span>
            Prize 
          </div>
          <div class="date">17.05.2024</div>
        </div>
        
      </div>

      <div class="winner-item">

        <div class="winner-info">

          <div class="winner-photo">
            <img src="img/photo4.jpg" alt="">
        </div>

        <div class="winner-name">
          Mia
        </div>
        </div>

        <div class="date-quantity">
          <div class="quantity">
            <span>5</span>
            Prize 
          </div>
          <div class="date">17.05.2024</div>
        </div>
        
      </div>

      <div class="winner-item">

        <div class="winner-info">

          <div class="winner-photo">
            <img src="img/photo5.png" alt="">
        </div>

        <div class="winner-name">
          Amelia
        </div>
        </div>

        <div class="date-quantity">
          <div class="quantity">
            <span>1</span>
            Prize 
          </div>
          <div class="date">17.05.2024</div>
        </div>
        
      </div>


      <div class="winner-item">

        <div class="winner-info">

          <div class="winner-photo">
            <img src="img/photo6.jpg" alt="">
        </div>

        <div class="winner-name">
          Harper
        </div>
        </div>

        <div class="date-quantity">
          <div class="quantity">
            <span>5</span>
            Prize 
          </div>
          <div class="date">17.05.2024</div>
        </div>
        
      </div>

      <div class="winner-item">

        <div class="winner-info">

          <div class="winner-photo">
            <img src="img/photo7.jpg" alt="">
        </div>

        <div class="winner-name">
          Charlotte
        </div>
        </div>

        <div class="date-quantity">
          <div class="quantity">
            <span>4</span>
            Prize 
          </div>
          <div class="date">17.05.2024</div>
        </div>
        
      </div>

      <div class="winner-item">

        <div class="winner-info">

          <div class="winner-photo">
            <img src="img/photo2.jpg" alt="">
        </div>

        <div class="winner-name">
          Lily
        </div>
        </div>

        <div class="date-quantity">
          <div class="quantity">
            <span>3</span>
            Prize 
          </div>
          <div class="date">17.05.2024</div>
        </div>
        
      </div>

      <div class="winner-item">

        <div class="winner-info">

          <div class="winner-photo">
            <img src="img/photo3.jpg" alt="">
        </div>

        <div class="winner-name">
          Lily
        </div>
        </div>

        <div class="date-quantity">
          <div class="quantity">
            <span>2</span>
            Prize 
          </div>
          <div class="date">17.05.2024</div>
        </div>
        
      </div>

      <div class="winner-item">

        <div class="winner-info">

          <div class="winner-photo">
            <img src="img/photo4.jpg" alt="">
        </div>

        <div class="winner-name">
          Grace
        </div>
        </div>

        <div class="date-quantity">
          <div class="quantity">
            <span>3</span>
            Prize 
          </div>
          <div class="date">17.05.2024</div>
        </div>
        
      </div>

      <div class="winner-item">

        <div class="winner-info">

          <div class="winner-photo">
            <img src="img/photo5.png" alt="">
        </div>

        <div class="winner-name">
          Ella
        </div>
        </div>

        <div class="date-quantity">
          <div class="quantity">
            <span>2</span>
            Prize 
          </div>
          <div class="date">17.05.2024</div>
        </div>
        
      </div>

      <div class="winner-item">

        <div class="winner-info">

          <div class="winner-photo">
            <img src="img/photo6.jpg" alt="">
        </div>

        <div class="winner-name">
          Abigail
        </div>
        </div>

        <div class="date-quantity">
          <div class="quantity">
            <span>5</span>
            Prize 
          </div>
          <div class="date">17.05.2024</div>
        </div>
        
      </div>

      <div class="winner-item">

        <div class="winner-info">

          <div class="winner-photo">
            <img src="img/photo7.jpg" alt="">
        </div>

        <div class="winner-name">
          Madison
        </div>
        </div>

        <div class="date-quantity">
          <div class="quantity">
            <span>1</span>
            Prize 
          </div>
          <div class="date">17.05.2024</div>
        </div>
        
      </div>

      <div class="winner-item">

        <div class="winner-info">

          <div class="winner-photo">
            <img src="img/photo.png" alt="">
        </div>

        <div class="winner-name">
          Chloe
        </div>
        </div>

        <div class="date-quantity">
          <div class="quantity">
            <span>4</span>
            Prize 
          </div>
          <div class="date">17.05.2024</div>
        </div>
        
      </div>

      <div class="winner-item">

        <div class="winner-info">

          <div class="winner-photo">
            <img src="img/p1.png" alt="">
        </div>

        <div class="winner-name">
          Scarlett
        </div>
        </div>

        <div class="date-quantity">
          <div class="quantity">
            <span>3</span>
            Prize 
          </div>
          <div class="date">17.05.2024</div>
        </div>
        
      </div>

      <div class="winner-item">

        <div class="winner-info">

          <div class="winner-photo">
            <img src="img/p2.png" alt="">
        </div>

        <div class="winner-name">
          Aria
        </div>
        </div>

        <div class="date-quantity">
          <div class="quantity">
            <span>1</span>
            Prize 
          </div>
          <div class="date">17.05.2024</div>
        </div>
        
      </div>


    </div>
  </div>
  <!-- end winners list -->
</div>
<!-- end content -->

<!-- start modal -->
<div class="prize-screen" id="prize-modal">
  <div class="modal-content">
    <h2>CONGRATULATIONS!</h2>
    <div class="confetti">🎉</div>
    <p>You got <span id="prize-name"></span></p>
    <button id="done" class="button">DONE</button>
  </div>
</div>
<!-- end modal -->
<audio id="audio" src="audio/voice.mp3" type="audio/mp3"></audio>
<audio id="winAudio" src="audio/win.mp3" type="audio/mp3"></audio>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const spinButton = document.getElementById("spin");
  const wheel = document.getElementById("wheel");
  const prizeTitle = document.getElementById("prize-title");
  const audio = document.getElementById("audio");
  const winAudio = document.getElementById("winAudio");
  const doneButton = document.getElementById("done");
  const prizeModal = document.getElementById("prize-modal");
  const prizeName = document.getElementById("prize-name");

  let isSpinning = false;
  let sectorsCount = 6; // Change this value to set the number of sectors
  let sectorColors = ["#FF2244", "#FFCC44", "#04C1CD", "#00BB88", "#BB33EE", "#FFAA22", "#22BBFF", "grey"];
  let sectorTexts = ["Prize 1", "Prize 2", "Prize 3", "Prize 4", "Prize 5", "Prize 6", "Prize 7", "Prize 8"];
  let winningOption = 2; // Winning sector number

  doneButton.addEventListener('click', () => {
    prizeModal.style.display = "none";
    document.body.style.backgroundColor = "";
    spinButton.disabled = false;
  });

  const darkenColor = (color, percent) => {
    const num = parseInt(color.slice(1), 16),
          amt = Math.round(2.55 * percent),
          R = (num >> 16) - amt,
          G = (num >> 8 & 0x00FF) - amt,
          B = (num & 0x0000FF) - amt;
    return `#${(0x1000000 + (R < 0 ? 0 : R) * 0x10000 + (G < 0 ? 0 : G) * 0x100 + (B < 0 ? 0 : B)).toString(16).slice(1).toUpperCase()}`;
  };

  const createSectors = (count, colors, texts) => {
    wheel.innerHTML = '';
    const angleStep = 360 / count;
    const radius = 150;
    const borderRadius = 150; // Radius for the border
    const centerX = 160;
    const centerY = 160;
    const svgNS = "http://www.w3.org/2000/svg";

    const svg = document.createElementNS(svgNS, "svg");
    svg.setAttribute("viewBox", "0 0 320 320");

    for (let i = 0; i < count; i++) {
      const startAngle = angleStep * i;
      const endAngle = angleStep * (i + 1);

      const x1 = centerX + radius * Math.cos(Math.PI * startAngle / 180);
      const y1 = centerY + radius * Math.sin(Math.PI * startAngle / 180);
      const x2 = centerX + radius * Math.cos(Math.PI * endAngle / 180);
      const y2 = centerY + radius * Math.sin(Math.PI * endAngle / 180);

      const path = document.createElementNS(svgNS, "path");
      const d = `M ${centerX} ${centerY} L ${x1} ${y1} A ${radius} ${radius} 0 0 1 ${x2} ${y2} Z`;

      path.setAttribute("d", d);
      path.setAttribute("fill", colors[i % colors.length]);

      const borderPath = document.createElementNS(svgNS, "path");
      const borderD = `M ${x1} ${y1} A ${borderRadius} ${borderRadius} 0 0 1 ${x2} ${y2}`;
      borderPath.setAttribute("d", borderD);
      borderPath.setAttribute("fill", "none");
      borderPath.setAttribute("stroke", colors[i % colors.length]);
      borderPath.setAttribute("stroke-opacity", "0.5");
      borderPath.setAttribute("stroke-width", "10");

      const text = document.createElementNS(svgNS, "text");
      const midAngle = startAngle + angleStep / 2;
      const textX = centerX + radius * 0.6 * Math.cos(Math.PI * midAngle / 180); // Adjusted distance from center
      const textY = centerY + radius * 0.6 * Math.sin(Math.PI * midAngle / 180); // Adjusted distance from center
      text.setAttribute("x", textX);
      text.setAttribute("y", textY);
      text.setAttribute("dy", "0.35em");
      text.setAttribute("text-anchor", "middle");
      text.setAttribute("fill", darkenColor(colors[i % colors.length], 50));
      text.setAttribute("transform", `rotate(${midAngle - 0} ${textX} ${textY})`);
      text.textContent = texts[i % texts.length];

      svg.appendChild(path);
      svg.appendChild(borderPath);
      svg.appendChild(text);
    }

    wheel.appendChild(svg);
    // Set initial position to sector 5
    const initialRotationDegrees = (360 - (5 - 1) * (360 / sectorsCount)) - (360 / sectorsCount) / 2;
    wheel.style.transform = `rotate(${initialRotationDegrees}deg)`;
    prizeTitle.textContent = sectorTexts[4]; // Set initial value in prize-title
  };

  const startSpin = () => {
    if (isSpinning) return;
    isSpinning = true;
    spinButton.disabled = true;

    const totalRotations = 5; // Increase the number of rotations
    const angleStep = 360 / sectorsCount;
    const finalRotationDegrees = 360 * totalRotations + (360 - ((winningOption - 1) * angleStep)) - (angleStep / 2);
    const spinDuration = 12000; // Spin duration

    let lastPlayedSector = -1;
    const initialRotationDegrees = getRotationDegrees(); // Get initial angle

    const checkForAudio = setInterval(() => {
      const currentRotation = getRotationDegrees();
      const correctedRotation = (currentRotation - initialRotationDegrees + 360) % 360; // Consider initial offset
      const currentSector = Math.floor(correctedRotation / angleStep);

      if (currentSector !== lastPlayedSector) {
        audio.currentTime = 0;
        audio.play();
        prizeTitle.textContent = sectorTexts[(5 - currentSector + sectorsCount - 1) % sectorsCount];
        lastPlayedSector = currentSector;
      }
    }, 100); // Check every 100 ms

    wheel.style.transition = `transform ${spinDuration / 1000}s cubic-bezier(0.25, 0.1, 0.25, 1)`;
    wheel.style.transform = `rotate(${finalRotationDegrees}deg)`;

    setTimeout(() => {
      clearInterval(checkForAudio);
      onFinish();
    }, spinDuration);
  };

  const getRotationDegrees = () => {
    const transform = window.getComputedStyle(wheel).transform;
    if (transform === 'none') return 0;
    const values = transform.split('(')[1].split(')')[0].split(',');
    const a = values[0];
    const b = values[1];
    const angle = Math.round(Math.atan2(b, a) * (180 / Math.PI));
    return (angle < 0 ? angle + 360 : angle);
  };

  const onFinish = () => {
    isSpinning = false;
    document.body.style.backgroundColor = "#D1FFFC";

    const finalSector = (winningOption - 1 + sectorsCount) % sectorsCount;
    prizeName.textContent = sectorTexts[finalSector];
    prizeTitle.textContent = sectorTexts[finalSector];

    setTimeout(() => {
      prizeModal.style.display = "block";
      winAudio.play();
    }, 1000);
  };

  spinButton.addEventListener('click', startSpin);

  // Initialize sectors
  createSectors(sectorsCount, sectorColors, sectorTexts);
});

</script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
  var winnerNameDiv = document.querySelector('.winner-name');
  var nameText = winnerNameDiv.textContent.trim();

  if (nameText.length > 11) {
      winnerNameDiv.textContent = nameText.substring(0, 11) + '...';
  }
});

</script>
</body>

</html>